# 🎨 前端簡化 - 智能需求解析

## 📋 更新說明

### 改進內容

前端介面已經簡化，**移除了「進階選項」區塊**，因為系統會自動智能解析使用者的完整需求。

### 為什麼這樣做？

1. **更簡潔的介面** - 減少使用者需要填寫的欄位
2. **更自然的互動** - 使用者可以用自然語言描述所有需求
3. **智能解析** - 後端會自動提取時間、數量、語言等資訊

---

## ✨ 自動解析功能

系統會從使用者的「搜尋需求」中自動提取：

### 📅 時間範圍
- ✅ 「最近一週」→ 解析為「最近 7 天內」
- ✅ 「上個月」→ 解析為「最近 30 天內」
- ✅ 「最近三天」→ 解析為「最近 3 天內」
- ✅ 未指定 → 預設「最近 7 天內」

### 🔢 新聞數量
- ✅ 「10 篇新聞」→ 解析為「10篇」
- ✅ 「5-8 則」→ 解析為「5-8篇」
- ✅ 「大約 15 篇」→ 解析為「15篇左右」
- ✅ 未指定 → 預設「5-10篇」

### 🌐 語言偏好
- ✅ 「英文新聞」→ 解析為「English」
- ✅ 「中文報導」→ 解析為「Chinese」
- ✅ 「越南文」→ 解析為「Vietnamese」
- ✅ 未指定 → 預設「English」

---

## 📝 使用範例

### 範例 1：完整需求描述
```
搜尋最近一週關於新加坡金融科技的英文新聞，大約 8-10 篇
```

**系統會解析為**：
- 主題：新加坡金融科技
- 時間：最近一週（7天）
- 數量：8-10 篇
- 語言：英文

---

### 範例 2：簡單需求
```
越南股市最新動態
```

**系統會解析為**：
- 主題：越南股市最新動態
- 時間：最近 7 天內（預設）
- 數量：5-10 篇（預設）
- 語言：English（預設）

---

### 範例 3：指定語言和時間
```
幫我找最近一個月關於泰國經濟政策的中文報導，5 篇左右
```

**系統會解析為**：
- 主題：泰國經濟政策
- 時間：最近一個月
- 數量：5 篇左右
- 語言：中文

---

## 🎯 前端變更詳情

### 移除的內容
- ❌ 語言下拉選單
- ❌ 時間範圍輸入框
- ❌ 新聞數量輸入框
- ❌ 「進階選項」區塊

### 新增的內容
- ✅ 智能解析說明提示框
- ✅ 更詳細的搜尋需求範例
- ✅ 使用提示（emoji + 列表）

### 保留的內容
- ✅ 搜尋需求輸入（多行文字框）
- ✅ 收件者信箱輸入
- ✅ 提交按鈕
- ✅ 進度追蹤
- ✅ 狀態顯示

---

## 💻 技術實作

### 前端變更
**檔案**：`public/index.html`

**API 請求簡化**：
```javascript
// 之前（有進階選項）
body: JSON.stringify({
    user_prompt: userPrompt,
    email: email,
    language: language,        // 移除
    time_range: timeRange,     // 移除
    count_hint: countHint      // 移除
})

// 現在（自動解析）
body: JSON.stringify({
    user_prompt: userPrompt,
    email: email
})
```

### 後端處理
**檔案**：`app/services/workflow.py`

後端的 `_parse_prompt()` 方法會使用 GPT 模型自動提取：
1. 核心搜尋主題（keywords）
2. 時間範圍指令（time_instruction）
3. 數量指令（num_instruction）
4. 語言偏好（language）

```python
def _parse_prompt(self, task_id: str, user_prompt: str) -> dict:
    """使用 LLM 解析用戶 prompt"""
    # GPT 會自動提取所有資訊
    parsed_data = agent.run(prompt)
    
    return {
        "keywords": "...",
        "time_instruction": "...",
        "num_instruction": "...",
        "language": "..."
    }
```

---

## 🎨 新版介面預覽

```
┌─────────────────────────────────────────────┐
│  🌏 東南亞金融新聞搜尋系統                   │
│  輸入您的搜尋需求，系統將自動生成報告        │
│  並發送至您的信箱                            │
├─────────────────────────────────────────────┤
│                                             │
│  搜尋需求 *                                  │
│  ┌─────────────────────────────────────┐   │
│  │ 請詳細描述您的需求，例如：           │   │
│  │ • 「搜尋最近一週關於新加坡金融科技   │   │
│  │    的英文新聞，大約 8-10 篇」       │   │
│  │ • 「幫我找最近一個月越南股市的中文   │   │
│  │    報導，5 篇左右」                 │   │
│  └─────────────────────────────────────┘   │
│                                             │
│  收件者信箱 *                                │
│  [ your.email@example.com              ]   │
│                                             │
│  ┌───────────────────────────────────────┐ │
│  │ 💡 提示：系統會自動解析您的需求，     │ │
│  │    包括：                             │ │
│  │ • 📅 時間範圍（例如：「最近一週」）   │ │
│  │ • 🔢 新聞數量（例如：「10篇新聞」）   │ │
│  │ • 🌐 語言偏好（例如：「英文新聞」）   │ │
│  │                                       │ │
│  │ 只需在上方輸入您的完整需求即可！      │ │
│  └───────────────────────────────────────┘ │
│                                             │
│  [        開始搜尋        ]                 │
│                                             │
└─────────────────────────────────────────────┘
```

---

## ✅ 優勢

### 使用者體驗
1. **更簡單** - 只需填寫兩個欄位
2. **更直覺** - 用自然語言描述需求
3. **更快速** - 減少填寫時間

### 技術優勢
1. **更智能** - 利用 GPT 理解自然語言
2. **更靈活** - 支援各種描述方式
3. **更容錯** - 有預設值，不會出錯

### 維護優勢
1. **更簡潔** - 前端代碼更少
2. **更一致** - 所有邏輯在後端
3. **更易擴展** - 只需修改解析邏輯

---

## 📊 對比

| 項目 | 舊版（進階選項） | 新版（智能解析） |
|------|----------------|-----------------|
| **輸入欄位** | 5 個 | 2 個 |
| **填寫時間** | ~2 分鐘 | ~30 秒 |
| **學習曲線** | 需要理解選項 | 自然語言即可 |
| **錯誤率** | 可能選錯選項 | 系統智能判斷 |
| **靈活性** | 受限於選項 | 無限靈活 |
| **程式碼量** | 多 ~100 行 | 少 ~100 行 |

---

## 🔄 API 變更

### 請求參數簡化

**之前**：
```json
{
  "user_prompt": "新加坡金融科技",
  "email": "user@example.com",
  "language": "English",
  "time_range": "最近 7 天內",
  "count_hint": "5-10篇"
}
```

**現在**：
```json
{
  "user_prompt": "搜尋最近一週關於新加坡金融科技的英文新聞，大約 8-10 篇",
  "email": "user@example.com"
}
```

**向後相容**：
- ✅ API 仍然接受 `language`、`time_range`、`count_hint` 參數
- ✅ 如果提供，會覆蓋自動解析的結果
- ✅ 如果不提供，會從 `user_prompt` 自動解析

---

## 🚀 立即體驗

1. 訪問：http://127.0.0.1:8000/static/index.html
2. 輸入完整的搜尋需求（包含時間、數量、語言）
3. 輸入郵箱
4. 提交並等待結果

**範例輸入**：
```
請幫我搜尋最近兩週關於越南電商市場的中文新聞報導，大約 6-8 篇
```

系統會自動：
- 搜尋越南電商市場相關新聞
- 限定在最近兩週內
- 找 6-8 篇新聞
- 優先選擇中文來源
- 生成報告並發送到你的信箱

---

**更新日期**：2025-01-16  
**版本**：2.1.0
